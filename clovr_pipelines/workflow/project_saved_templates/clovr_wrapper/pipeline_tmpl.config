[run_workflow prestart]
$;WORKFLOW_XML$;=${pipeline.PRESTART_TEMPLATE_XML}
$;USER_CONFIG$;=${pipeline_conf}

;Start master only
[run_command startcluster]
$;INPUT_COMMAND$;=echo 
;/opt/vappio-py/vappio/cli/startCluster.py 
$;INPUT_ARGS$;=starting master
;--conf ${cluster.CLOVR_CONF} --name ${cluster.CLUSTER_TAG} --num ${cluster.EXEC_NODES} --ctype ${cluster.CLUSTER_TYPE} -b

[run_workflow prerun]
$;WORKFLOW_XML$;=${pipeline.PRERUN_TEMPLATE_XML}
$;USER_CONFIG$;=${pipeline_conf}

;Submit pipeline
[run_command runpipeline]
$;INPUT_COMMAND$;=/opt/vappio-py/vappio/cli/runPipeline.py 
$;INPUT_ARGS$;=--name ${cluster.CLUSTER_TAG} --pipeline-name ${input.PIPELINE_NAME} --pipeline ${pipeline.PIPELINE_TEMPLATE} -- ${pipeline.PIPELINE_ARGS}

[run_command pipelinestatus]
$;INPUT_COMMAND$;=echo
;/opt/vappio-py/vappio/cli/pipelineStatus.py 
$;INPUT_ARGS$;=pipeline status
;--name ${input.PIPELINE_NAME} --wait

[run_command downloadoutput]
$;INPUT_COMMAND$;=echo 
;/opt/vappio-py/vappio/cli/downloadPipelineOutput.py 
$;INPUT_ARGS$;=download data
;--name ${cluster.CLUSTER_TAG} --pipeline ${input.PIPELINE_NAME} --output_dir ${output.OUTPUT_DIRECTORY} --overwrite

[run_workflow postrun]
$;WORKFLOW_XML$;=${pipeline.POSTRUN_TEMPLATE_XML}
$;USER_CONFIG$;=${pipeline_conf}